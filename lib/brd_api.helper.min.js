!function(){var n,t=!1,e=!1,o="bright_sdk.status",i=localStorage.getItem(o),c=function(){t&&console.log.apply(console,arguments)},r=function(){e&&console.error.apply(console,arguments)},s=[],u="Service",a=!1,l=!1,f={init:function(n){return t=n.debug,e=n.debug||n.verbose,l=n.simple_opt_out,u=n.tizen_service_name||u,f.startService().then(function(){return new Promise(function(t,e){f.getBrightApi(!1).then(function(o){c("init with settings: %o",n);var u=n.on_status_change,l=n.skip_consent;n.external_consent_options&&(f.createDialog(n),n.external_consent_options=void 0,n.skip_consent=!0,n.simple_opt_out=void 0),n.on_status_change=function(){try{var n=o.get_status(),t=n?n.value?n.value.consent:n.consent:null;f.onStatusChangeFn(t);for(var e=0;e<s.length;e++)s[e](t);s=[],u&&u(t)}catch(n){r(n)}};try{o.init(n,{on_failure:function(n){r("init failure. Error: ",n),e(new Error(n))},on_success:function(){c("init success"),a=!0,t(),l||i||f.showConsent(),f.showNotification(1e4)}})}catch(n){r(n),e()}})})})},isInited:function(){return a},enable:function(n){return new Promise(function(t,e){return f.getBrightApi().then(function(o){if(!n)return f.onceStatusChange(t,"enableResolve",!0),f.showConsent().catch(e);o.external_opt_in({on_failure:function(n){r("external_opt_in failure",n),e()},on_success:function(){c("external_opt_in success"),t()}})})})},disable:function(){return i="disabled",new Promise(function(n,t){f.onceStatusChange(n,"disableResolve",!0),f.getBrightApi().then(function(n){n.opt_out({on_failure:function(n){r("opt_out failure",n),i="enabled",t()},on_success:function(){c("opt_out success")}})})})},showConsent:function(){if(n)return n.show(i);if(l){var t=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:53,which:53,key:"5",code:"Digit5"});return document.dispatchEvent(t),Promise.resolve()}return new Promise(function(n,t){f.getBrightApi().then(function(e){e.show_consent({on_failure:function(n){r("show_consent failure: ",n),t(n)},on_success:function(){c("show_consent success"),n()}})})})},createDialog:function(t){if(window.ConsentModule){if(!n){var[e,o]=t.external_consent_options;l&&(o.Out=!0);var i,c=o.onShow,s=o.onAccept,u=o.onDecline,a=o.onClose;o.onAccept=function(){f.enable(!0),s&&s()},o.onDecline=function(){f.disable(),u&&u()},o.onShow=function(){f.reportConsentShown(),c&&c()},o.onClose=function(){p(),a&&a()},n=ConsentModule.create(e,o),p()}}else r("ConsentModule not found, have you included it?");function p(){o.simpleOptOut&&(i=function(n){53==n.keyCode&&(n.preventDefault(),n.stopPropagation(),f.showConsent())},document.addEventListener("keydown",i,{capture:!0,once:!0}))}},onceStatusChange:function(n,t,e){e||(s=[]);var o=s.length;s.push(function(e){c("calling once hook %d: %s",o,t),n(e)})},onStatusChangeFn:function(n){c("BRD status changed ----- ",n),null!=n&&(i=n?"enabled":"disabled",localStorage.setItem(o,i))},getStatus:function(){return i},getStatusObject:function(){return f.getBrightApi().then(function(n){return n.get_status()})},isEnabled:function(){return"enabled"==i},startService:function(){return window.tizen?(c("detected OS: Tizen"),new Promise(function(n,t){var e=tizen.application.getCurrentApplication().appInfo.packageId+"."+u,o=new tizen.ApplicationControlData("caller",["ForegroundApp"]),i=new tizen.ApplicationControl("http://tizen.org/appcontrol/operation/pick",null,null,null,[o]);return f.getBrightApi(!1).then(function(o){o.set_alarm&&o.set_alarm(e),tizen.application.launchAppControl(i,e,n,t)})})):Promise.resolve()},showNotification:function(t){n&&n.showNotification(t)},reportConsentShown:function(){return f.getBrightApi().then(function(n){n.consent_shown()})},getBrightApi:function(n=!0,t=1e3){return Promise.resolve().then(function(){return n&&!a||!window.brd_api?(r("BRD API not available, retry in 1 sec..."),(e=t,new Promise(function(n){setTimeout(n,e)})).then(f.getBrightApi)):window.brd_api;var e})}};window.BrightSDK=f}();